"""
üîå –¢–ï–°–¢–ï–† –°–û–ï–î–ò–ù–ï–ù–ò–Ø –° GOOGLE SCRIPT
–í–µ—Ä—Å–∏—è: 1.0
–ê–≤—Ç–æ—Ä: AI Assistant

–≠—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Google Script
–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞
"""

import requests
import json
import sys
from datetime import datetime

# ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
# URL –≤–∞—à–µ–≥–æ Google Apps Script
GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyuL_A7CyFHtgvBKKSK74swazQSlj0kwDWY4ITENdOcP-GPMZ1h1JblAEsg4zr3N-a7/exec"

# ========== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï ==========
def print_separator():
    """–í—ã–≤–µ—Å—Ç–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å"""
    print("=" * 60)

def test_connection_basic():
    """–ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"""
    print_separator()
    print("üîå –¢–ï–°–¢–ï–† –°–û–ï–î–ò–ù–ï–ù–ò–Ø –° GOOGLE SCRIPT")
    print_separator()
    print(f"üìÖ –í—Ä–µ–º—è —Ç–µ—Å—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print(f"üìé URL –¥–ª—è —Ç–µ—Å—Ç–∞: {GOOGLE_SCRIPT_URL}")
    print_separator()
    
    # –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ URL
    print("\nüìã –¢–ï–°–¢ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ URL")
    if GOOGLE_SCRIPT_URL.startswith("https://script.google.com/"):
        print("‚úÖ URL –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç")
    else:
        print("‚ùå URL –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç")
        print("   –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å: https://script.google.com/")
    
    # –¢–µ—Å—Ç 2: HTTP GET –∑–∞–ø—Ä–æ—Å
    print("\nüìã –¢–ï–°–¢ 2: HTTP GET –∑–∞–ø—Ä–æ—Å")
    try:
        response = requests.get(
            GOOGLE_SCRIPT_URL,
            timeout=10,
            verify=False
        )
        print(f"‚úÖ GET –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω")
        print(f"   –°—Ç–∞—Ç—É—Å –∫–æ–¥: {response.status_code}")
        print(f"   –ó–∞–≥–æ–ª–æ–≤–∫–∏: {dict(response.headers).get('Content-Type', '–Ω–µ —É–∫–∞–∑–∞–Ω')}")
        
        if response.status_code == 200:
            print("   ‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω")
        else:
            print(f"   ‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –∫–æ–¥: {response.status_code}")
            
    except requests.exceptions.Timeout:
        print("‚ùå –¢–∞–π–º–∞—É—Ç GET –∑–∞–ø—Ä–æ—Å–∞")
    except requests.exceptions.ConnectionError:
        print("‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è GET –∑–∞–ø—Ä–æ—Å–∞")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ GET –∑–∞–ø—Ä–æ—Å–∞: {str(e)[:100]}")
    
    # –¢–µ—Å—Ç 3: HTTP POST –∑–∞–ø—Ä–æ—Å —Å action=test
    print("\nüìã –¢–ï–°–¢ 3: HTTP POST –∑–∞–ø—Ä–æ—Å (action=test)")
    try:
        payload = {"action": "test"}
        print(f"   –û—Ç–ø—Ä–∞–≤–∫–∞: {json.dumps(payload)}")
        
        response = requests.post(
            GOOGLE_SCRIPT_URL,
            json=payload,
            timeout=15,
            verify=False,
            headers={'Content-Type': 'application/json'}
        )
        
        print(f"   –°—Ç–∞—Ç—É—Å –∫–æ–¥: {response.status_code}")
        print(f"   –ó–∞–≥–æ–ª–æ–≤–∫–∏: {dict(response.headers).get('Content-Type', '–Ω–µ —É–∫–∞–∑–∞–Ω')}")
        print(f"   –î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞: {len(response.text)} —Å–∏–º–≤–æ–ª–æ–≤")
        
        if response.status_code == 200:
            print("   ‚úÖ POST –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–µ–Ω")
            
            # –ü—Ä–æ–±—É–µ–º —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON
            try:
                data = response.json()
                print("   ‚úÖ JSON –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω")
                print(f"   –°–æ–¥–µ—Ä–∂–∏–º–æ–µ: {json.dumps(data, indent=2, ensure_ascii=False)[:200]}...")
                
                if data.get('status') == 'success':
                    print("   ‚úÖ –°—Ç–∞—Ç—É—Å 'success' –ø–æ–ª—É—á–µ–Ω")
                else:
                    print(f"   ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å: {data.get('status', '–Ω–µ —É–∫–∞–∑–∞–Ω')}")
                    
            except json.JSONDecodeError:
                print("   ‚ùå –ù–ï–í–ï–†–ù–´–ô JSON –û–¢–í–ï–¢")
                print(f"   –ü–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤ –æ—Ç–≤–µ—Ç–∞:")
                print("-" * 40)
                print(response.text[:500])
                print("-" * 40)
        else:
            print(f"   ‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –∫–æ–¥: {response.status_code}")
            
    except requests.exceptions.Timeout:
        print("‚ùå –¢–∞–π–º–∞—É—Ç POST –∑–∞–ø—Ä–æ—Å–∞ (15 —Å–µ–∫—É–Ω–¥)")
    except requests.exceptions.ConnectionError:
        print("‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è POST –∑–∞–ø—Ä–æ—Å–∞")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ POST –∑–∞–ø—Ä–æ—Å–∞: {str(e)[:100]}")
    
    # –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö actions
    print("\nüìã –¢–ï–°–¢ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö API –º–µ—Ç–æ–¥–æ–≤")
    
    test_actions = ["test", "get_stats", "get_quotas", "get_available_dates"]
    
    for action in test_actions:
        print(f"\n   ‚ñ∂Ô∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ action: '{action}'")
        try:
            response = requests.post(
                GOOGLE_SCRIPT_URL,
                json={"action": action},
                timeout=10,
                verify=False
            )
            
            if response.status_code == 200:
                try:
                    data = response.json()
                    status = data.get('status', 'unknown')
                    print(f"      –°—Ç–∞—Ç—É—Å: {status}")
                    
                    if status == 'success':
                        print(f"      ‚úÖ –£—Å–ø–µ—à–Ω–æ")
                    else:
                        print(f"      ‚ö†Ô∏è –û—à–∏–±–∫–∞: {data.get('data', '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')[:50]}")
                except:
                    print(f"      ‚ùå –ù–µ JSON –æ—Ç–≤–µ—Ç")
            else:
                print(f"      ‚ùå HTTP {response.status_code}")
                
        except Exception as e:
            print(f"      ‚ùå –û—à–∏–±–∫–∞: {str(e)[:50]}")

def test_with_different_methods():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏"""
    print_separator()
    print("\nüìã –¢–ï–°–¢ 5: –†–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏")
    
    # –ú–µ—Ç–æ–¥ 1: json –ø–∞—Ä–∞–º–µ—Ç—Ä
    print("\n   –ú–µ—Ç–æ–¥ 1: requests.post(json=...)")
    try:
        response = requests.post(
            GOOGLE_SCRIPT_URL,
            json={"action": "test"},
            timeout=10,
            verify=False
        )
        print(f"      –°—Ç–∞—Ç—É—Å: {response.status_code}")
        if response.status_code == 200:
            print("      ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç")
    except Exception as e:
        print(f"      ‚ùå {str(e)[:50]}")
    
    # –ú–µ—Ç–æ–¥ 2: data —Å json.dumps
    print("\n   –ú–µ—Ç–æ–¥ 2: requests.post(data=json.dumps())")
    try:
        response = requests.post(
            GOOGLE_SCRIPT_URL,
            data=json.dumps({"action": "test"}),
            headers={'Content-Type': 'application/json'},
            timeout=10,
            verify=False
        )
        print(f"      –°—Ç–∞—Ç—É—Å: {response.status_code}")
        if response.status_code == 200:
            print("      ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç")
    except Exception as e:
        print(f"      ‚ùå {str(e)[:50]}")
    
    # –ú–µ—Ç–æ–¥ 3: params –≤ URL
    print("\n   –ú–µ—Ç–æ–¥ 3: requests.get(params=...)")
    try:
        response = requests.get(
            GOOGLE_SCRIPT_URL,
            params={"action": "test"},
            timeout=10,
            verify=False
        )
        print(f"      –°—Ç–∞—Ç—É—Å: {response.status_code}")
        if response.status_code == 200:
            print("      ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç")
    except Exception as e:
        print(f"      ‚ùå {str(e)[:50]}")

def check_ssl_certificate():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞"""
    print_separator()
    print("\nüìã –¢–ï–°–¢ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞")
    
    # –° –ø—Ä–æ–≤–µ—Ä–∫–æ–π SSL
    try:
        response = requests.get(GOOGLE_SCRIPT_URL, timeout=5, verify=True)
        print("   ‚úÖ SSL –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç")
    except requests.exceptions.SSLError:
        print("   ‚ùå –û—à–∏–±–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞")
        print("   üí° –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ verify=False –≤ –∫–æ–¥–µ")
    except Exception as e:
        print(f"   ‚ö†Ô∏è {str(e)[:50]}")
    
    # –ë–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ SSL
    try:
        response = requests.get(GOOGLE_SCRIPT_URL, timeout=5, verify=False)
        print("   ‚úÖ –ë–µ–∑ SSL –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç")
    except Exception as e:
        print(f"   ‚ùå {str(e)[:50]}")

def diagnose_problems():
    """–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º"""
    print_separator()
    print("\nüîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú")
    print_separator()
    
    problems = []
    solutions = []
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 1: URL
    if not GOOGLE_SCRIPT_URL.startswith("https://script.google.com/"):
        problems.append("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç URL")
        solutions.append("üìå –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –∏–∑ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è")
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 2: –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
    try:
        response = requests.get(GOOGLE_SCRIPT_URL, timeout=5, verify=False)
        if response.status_code != 200:
            problems.append(f"‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–∫–æ–¥ {response.status_code})")
            solutions.append("üìå –ü–µ—Ä–µ–æ–ø—É–±–ª–∏–∫—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ")
    except:
        problems.append("‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç")
        solutions.append("üìå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ")
        solutions.append("üìå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω")
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 3: CORS
    try:
        response = requests.post(
            GOOGLE_SCRIPT_URL,
            json={"action": "test"},
            timeout=5,
            verify=False
        )
        if response.status_code == 200:
            try:
                response.json()
            except:
                problems.append("‚ùå –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ JSON")
                solutions.append("üìå –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è doPost –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON")
    except:
        pass
    
    # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    if problems:
        print("\nüî¥ –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ü–†–û–ë–õ–ï–ú–´:")
        for i, problem in enumerate(problems, 1):
            print(f"   {i}. {problem}")
        
        print("\nüí° –†–ï–®–ï–ù–ò–Ø:")
        for i, solution in enumerate(solutions, 1):
            print(f"   {i}. {solution}")
    else:
        print("\n‚úÖ –ü–†–û–ë–õ–ï–ú –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û")
        print("   –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Google Script —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")

def check_google_script_code():
    """–í—ã–≤–æ–¥ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è Google Script"""
    print_separator()
    print("\nüìã –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –ö–û–î –î–õ–Ø GOOGLE SCRIPT")
    print_separator()
    
    code = '''
function doGet(e) {
  return handleRequest(e.parameter);
}

function doPost(e) {
  var params;
  try {
    params = JSON.parse(e.postData.contents);
  } catch(error) {
    params = e.parameter;
  }
  return handleRequest(params);
}

function handleRequest(params) {
  var action = params.action;
  
  // –¢–µ—Å—Ç–æ–≤—ã–π endpoint
  if (action === "test") {
    return ContentService
      .createTextOutput(JSON.stringify({
        status: "success",
        data: {
          message: "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!",
          time: new Date().toISOString(),
          version: "1.0"
        }
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
  
  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  if (action === "get_stats") {
    return ContentService
      .createTextOutput(JSON.stringify({
        status: "success",
        data: {
          total_bookings: 125,
          total_users: 87,
          day_stats: {
            "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": {
              quotas: {"A+": 10, "A-": 5, "B+": 10, "B-": 5, "AB+": 5, "AB-": 3, "O+": 10, "O-": 5},
              total_quotas: 48
            },
            "–≤—Ç–æ—Ä–Ω–∏–∫": {
              quotas: {"A+": 10, "A-": 5, "B+": 10, "B-": 5, "AB+": 5, "AB-": 3, "O+": 10, "O-": 5},
              total_quotas: 48
            }
          }
        }
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
  
  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
  return ContentService
    .createTextOutput(JSON.stringify({
      status: "error",
      data: "Unknown action: " + action
    }))
    .setMimeType(ContentService.MimeType.JSON);
}
'''
    print(code)
    print_separator()
    print("üí° –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä Google Apps Script")
    print("üí° –û–ø—É–±–ª–∏–∫—É–π—Ç–µ: –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å > –ù–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ > –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ")
    print("üí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–æ—Å—Ç—É–ø: '–í—Å–µ, —É –∫–æ–≥–æ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞'")
    print_separator()

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    try:
        # –û—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è SSL
        import urllib3
        urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
    except:
        pass
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã
    test_connection_basic()
    test_with_different_methods()
    check_ssl_certificate()
    diagnose_problems()
    check_google_script_code()
    
    print_separator()
    print("\n‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û")
    print_separator()
    
    # –ò—Ç–æ–≥–æ–≤–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ
    print("\nüìä –ò–¢–û–ì–û–í–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:")
    print("1. –ï—Å–ª–∏ —Ç–µ—Å—Ç 3 (POST —Å action=test) –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ - –±–æ—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å")
    print("2. –ï—Å–ª–∏ —Ç–µ—Å—Ç 3 –≤–µ—Ä–Ω—É–ª –Ω–µ JSON - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ Google Script")
    print("3. –ï—Å–ª–∏ —Ç–µ—Å—Ç 3 –Ω–µ –ø—Ä–æ—à–µ–ª - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ URL –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—é —Å–∫—Ä–∏–ø—Ç–∞")
    print("4. –î–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MODE='HYBRID'")
    print("\nüí° –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Google Script –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç")

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\n‚ö†Ô∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Ä–≤–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\n\n‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()

    
    input("\n\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
